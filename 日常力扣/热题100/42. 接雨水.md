ğŸ·å›°éš¾ #æ ˆ #åŒæŒ‡é’ˆ #åŠ¨æ€è§„åˆ’

ç»™å®šÂ `n`Â ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸ºÂ `1`Â çš„æŸ±å­çš„é«˜åº¦å›¾ï¼Œè®¡ç®—æŒ‰æ­¤æ’åˆ—çš„æŸ±å­ï¼Œä¸‹é›¨ä¹‹åèƒ½æ¥å¤šå°‘é›¨æ°´ã€‚

**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/22/rainwatertrap.png)

>**è¾“å…¥ï¼š`height = [0,1,0,2,1,0,1,3,2,1,2,1]`
>è¾“å‡ºï¼š`6`
>è§£é‡Šï¼š`ä¸Šé¢æ˜¯ç”±æ•°ç»„ [0,1,0,2,1,0,1,3,2,1,2,1] è¡¨ç¤ºçš„é«˜åº¦å›¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¥ 6 ä¸ªå•ä½çš„é›¨æ°´ï¼ˆè“è‰²éƒ¨åˆ†è¡¨ç¤ºé›¨æ°´ï¼‰ã€‚ 

**ç¤ºä¾‹ 2ï¼š**

>**è¾“å…¥ï¼š`height = [4,2,0,3,2,5]`
>è¾“å‡ºï¼š`9`

**æç¤ºï¼š**

- `n == height.length`
- `1 <= n <= 2 * 104`
- `0 <= height[i] <= 105`

# è§£é¢˜æ€è·¯ä¸å®ç°

- **æ–¹æ³•ä¸€**ï¼šå¯ä»¥æŠŠå®ƒçœ‹åšä¸¤ä¸ªå›¾å½¢ï¼Œä¸€ä¸ªæ˜¯æœ‰é¢œè‰²çš„å›¾å½¢ï¼Œä¸€ä¸ªåªæœ‰é»‘è‰²å›¾å½¢ï¼Œä¸¤ä¸ªå›¾å½¢åšå‡æ³•ï¼Œå°±æ˜¯è“è‰²åŒºåŸŸï¼Œå³é›¨æ°´çš„æ•°é‡ã€‚å…³é”®å°±åœ¨äºæœ‰é¢œè‰²çš„å›¾å½¢å¦‚ä½•æ±‚è§£ï¼Œå¯ä»¥çœ‹å‡ºä»å·¦åˆ°å³ã€ä»å³åˆ°å·¦ï¼Œåªè¦ä¿è¯å…ƒç´ é‡åˆ°æ¯”å®ƒå¤§çš„å…ƒç´ å‰ï¼Œå…¨éƒ¨ç½®ä¸ºä¹‹å‰çš„æœ€å°å…ƒç´ å³å¯ã€‚
- **æ–¹æ³•äºŒ**ï¼šè¯¥ç®—æ³•çš„æ ¸å¿ƒåœ¨äºï¼Œå¯¹äºä»»ä½•ä½ç½® $i$ï¼š
$$\text{Water}[i] = \min(\text{max\_left}[i], \text{max\_right}[i]) - \text{height}[i]$$
	é€šè¿‡æ¯”è¾ƒ `height[left]` å’Œ `height[right]` æ¥åŠ¨æ€åœ°å†³å®šå½“å‰è®¡ç®—çš„æ°´ä½çº¿ï¼Œä»è€Œé¿å…äº†é¢„å…ˆå­˜å‚¨å·¦å³æœ€å¤§é«˜åº¦æ•°ç»„ï¼Œå®ç°äº† $O(1)$ ç©ºé—´ä¼˜åŒ–ã€‚
	1. **æ¯”è¾ƒçŸ­æ¿ (`if height[left] <= height[right]:`)**
    - ç®—æ³•é¦–å…ˆæ¯”è¾ƒå½“å‰å·¦å³æŒ‡é’ˆæ‰€æŒ‡çš„é«˜åº¦ï¼Œå¹¶**å§‹ç»ˆé€‰æ‹©ç§»åŠ¨è¾ƒçŸ­çš„é‚£ä¸€ä¾§**ï¼ˆè¿™æ˜¯çŸ­æ¿åŸç†ï¼‰ã€‚
	1. **å¤„ç†å·¦ä¾§ (å½“ `height[left]` æ˜¯çŸ­æ¿æ—¶)**
    - **æ›´æ–°æœ€å¤§å€¼ (`if height[left] >= left_max:`)**: å¦‚æœå½“å‰å·¦è¾¹é«˜åº¦æ›´é«˜ï¼Œå®ƒæˆä¸ºæ–°çš„å·¦ä¾§æœ€å¤§é«˜åº¦ `left_max`ã€‚è¯¥ä½ç½®æ— æ³•è“„æ°´ï¼Œä½†å®ƒå¯èƒ½æˆä¸ºæœªæ¥è“„æ°´çš„å¢™ã€‚
    - **è®¡ç®—è“„æ°´ (`else: water += left_max - height[left]`)**: å¦‚æœå½“å‰å·¦è¾¹é«˜åº¦æ¯” `left_max` ä½ï¼Œè¯´æ˜å®ƒå¤„äºä¸€ä¸ªå‡¹é™·åŒºã€‚ç”±äºæˆ‘ä»¬çŸ¥é“ `left_max <= right_max`ï¼ˆå› ä¸ºæˆ‘ä»¬é€‰æ‹©äº†ç§»åŠ¨çŸ­æ¿ï¼‰ï¼Œæ‰€ä»¥å½“å‰ä½ç½®çš„æ°´ä½çº¿ $\min(\text{max\_left}, \text{max\_right})$ å¿…å®šç”± **`left_max`** å†³å®šã€‚

| **ç‰¹æ€§ç»´åº¦**   | åŸºäºæœ€é«˜æŸ±å­åˆ’åˆ†**                                                                         | **åŒæŒ‡é’ˆæœ€ä¼˜è§£ (çŸ­æ¿åŸç†)**ğŸŒŸ                                                                                     |
| ---------- | ---------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- |
| **ç®—æ³•æ€æƒ³**   | **åˆ†æ²»/åŒºåŸŸå¡«å……**ï¼šé€šè¿‡ä¸‰æ¬¡éå†å’Œå…¨å±€æœ€é«˜æŸ±å­ ($\text{highest}$) å°†æ•°ç»„åˆ’åˆ†ä¸ºå·¦ã€ä¸­ã€å³ä¸‰ä¸ªåŒºåŸŸï¼Œå¹¶ç”¨å¡«å……æ³•æ„é€ å‡ºæ°´ä½çº¿æ•°ç»„ã€‚        | **è´ªå¿ƒæ”¶æ•›**ï¼šé€šè¿‡æ¯”è¾ƒå·¦å³ä¸¤ä¾§çš„å·²çŸ¥æœ€å¤§é«˜åº¦ ($\text{max\_l}, \text{max\_r}$) æ¥æŒ‡å¯¼æŒ‡é’ˆç§»åŠ¨ï¼ŒåŠ¨æ€è®¡ç®—å½“å‰ç‚¹çš„è“„æ°´ã€‚                           |
| **æ—¶é—´å¤æ‚åº¦**  | **$O(n)$**ï¼šéœ€è¦å¤šæ¬¡ï¼ˆ3æ¬¡ä»¥ä¸Šï¼‰çº¿æ€§éå†æ•°ç»„ã€‚                                                       | **$O(n)$**ï¼šåªéœ€ä¸€æ¬¡éå†ï¼ŒæŒ‡é’ˆä»ä¸¤ç«¯ç›¸å‘ç§»åŠ¨ã€‚                                                                            |
| **ç©ºé—´å¤æ‚åº¦**  | **$O(n)$**ï¼šéœ€è¦åˆ›å»ºå¹¶ç»´æŠ¤ä¸€ä¸ªé¢å¤–çš„æ•°ç»„ (`total`) æ¥å­˜å‚¨æ°´ä½çº¿ï¼Œè¿™å ç”¨äº†ä¸è¾“å…¥è§„æ¨¡æˆæ­£æ¯”çš„ç©ºé—´ã€‚                        | **$O(1)$**ï¼šä»…ä½¿ç”¨æœ‰é™çš„å‡ ä¸ªå˜é‡ (`left`, `right`, `max_l`, `max_r`)ï¼Œç©ºé—´æ•ˆç‡æœ€é«˜ã€‚                                       |
| **å¥å£®æ€§/åŸç†** | **é€»è¾‘å¤æ‚ä¸”ä¸å¥å£®**ï¼šå…¶æ­£ç¡®æ€§ä¾èµ–äºç‰¹å®šçš„ `break` æ¡ä»¶å’Œä¸­é—´å¡«å……é€»è¾‘ï¼Œå®¹æ˜“åœ¨å¤æ‚å¤šå³°æˆ–éå¯¹ç§°åœºæ™¯ä¸­å‡ºé”™ï¼ˆè™½ç„¶æ‚¨çš„ä»£ç ç»“æ„å¤æ‚ï¼Œä½†æ°å¥½é¿å…äº†ä¸€äº›é”™è¯¯ï¼‰ã€‚ | **é€»è¾‘ç®€æ´ä¸”å¥å£®**ï¼šç›´æ¥ä¸”ä¸¥æ ¼åœ°éµå¾ªæ¥é›¨æ°´çš„æ•°å­¦åŸç†ï¼š$\text{Water}[i] = \min(\text{max\_l}, \text{max\_r}) - \text{height}[i]$ã€‚ |
| **ä»£ç å®ç°**   | å¤æ‚ï¼ŒåŒ…å«å¤šæ¬¡å¾ªç¯ã€`copy.deepcopy` å’Œæ¡ä»¶ `break`ã€‚                                             | ç®€æ´ï¼Œç»“æ„æ¸…æ™°ï¼Œæ˜¯è¯¥é—®é¢˜çš„æ ‡å‡†æœ€ä¼˜è§£ã€‚                                                                                     |

## æ–¹æ³•ä¸€ï¼šæ‹†åˆ†æ³•

```python
import copy
class Solution:
Â  Â  def trap(self, height: list[int]) -> int:
Â  Â  Â  Â  length = len(height)
Â  Â  Â  Â  highest = max(height)
Â  Â  Â  Â  entire = copy.copy(height)
Â  Â  Â  Â  begin = end = 0
Â  Â  Â  Â  l_low = r_low = 0
Â  Â  Â  Â  for i in range(length):
Â  Â  Â  Â  Â  Â  if height[i] == highest:
Â  Â  Â  Â  Â  Â  Â  Â  begin = i
Â  Â  Â  Â  Â  Â  Â  Â  break
Â  Â  Â  Â  for i in range(length - 1, -1, -1):
Â  Â  Â  Â  Â  Â  if height[i] == highest:
Â  Â  Â  Â  Â  Â  Â  Â  end = i
Â  Â  Â  Â  Â  Â  Â  Â  break
Â  Â  Â  Â  for i in range(begin):
Â  Â  Â  Â  Â  Â  if entire[i] > l_low:
Â  Â  Â  Â  Â  Â  Â  Â  l_low = entire[i]
Â  Â  Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  Â  Â  entire[i] = l_low
Â  Â  Â  Â  for i in range(length - 1, end, -1):
Â  Â  Â  Â  Â  Â  if entire[i] > r_low:
Â  Â  Â  Â  Â  Â  Â  Â  r_low = entire[i]
Â  Â  Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  Â  Â  entire[i] = r_low
Â  Â  Â  Â  res1 = [entire[i] - height[i] for i in range(length)]
Â  Â  Â  Â  res2 = [highest - height[i] for i in range(begin, end)]
Â  Â  Â  Â  return sum(res1) + sum(res2)
```

## æ–¹æ³•äºŒï¼šåŒæŒ‡é’ˆğŸŒŸ

```python
class Solution:
    def trap(self, height: List[int]) -> int:
        if not height:
            return 0
        n = len(height)
        left, right = 0, n-1
        left_max, right_max = 0,0
        water = 0
        while left <= right:
            if height[left] < height[right]:
                if height[left] >= left_max:
                    left_max = height[left]
                else:
                    water += left_max - height[left]
                left += 1
            else:
                if height[right] >= right_max:
                    right_max = height[right]
                else:
                    water += right_max - height[right]
                right -= 1
        return water
```