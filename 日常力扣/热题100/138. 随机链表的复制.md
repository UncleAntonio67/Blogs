ğŸ·ä¸­ç­‰ #å“ˆå¸Œè¡¨ #é“¾è¡¨ 

ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸ºÂ `n`Â çš„é“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªé¢å¤–å¢åŠ çš„éšæœºæŒ‡é’ˆÂ `random`Â ï¼Œè¯¥æŒ‡é’ˆå¯ä»¥æŒ‡å‘é“¾è¡¨ä¸­çš„ä»»ä½•èŠ‚ç‚¹æˆ–ç©ºèŠ‚ç‚¹ã€‚

æ„é€ è¿™ä¸ªé“¾è¡¨çš„Â **[æ·±æ‹·è´]ã€‚Â æ·±æ‹·è´åº”è¯¥æ­£å¥½ç”±Â `n`Â ä¸ªÂ **å…¨æ–°**Â èŠ‚ç‚¹ç»„æˆï¼Œå…¶ä¸­æ¯ä¸ªæ–°èŠ‚ç‚¹çš„å€¼éƒ½è®¾ä¸ºå…¶å¯¹åº”çš„åŸèŠ‚ç‚¹çš„å€¼ã€‚æ–°èŠ‚ç‚¹çš„Â `next`Â æŒ‡é’ˆå’ŒÂ `random`Â æŒ‡é’ˆä¹Ÿéƒ½åº”æŒ‡å‘å¤åˆ¶é“¾è¡¨ä¸­çš„æ–°èŠ‚ç‚¹ï¼Œå¹¶ä½¿åŸé“¾è¡¨å’Œå¤åˆ¶é“¾è¡¨ä¸­çš„è¿™äº›æŒ‡é’ˆèƒ½å¤Ÿè¡¨ç¤ºç›¸åŒçš„é“¾è¡¨çŠ¶æ€ã€‚**å¤åˆ¶é“¾è¡¨ä¸­çš„æŒ‡é’ˆéƒ½ä¸åº”æŒ‡å‘åŸé“¾è¡¨ä¸­çš„èŠ‚ç‚¹**Â ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœåŸé“¾è¡¨ä¸­æœ‰Â `X`Â å’ŒÂ `Y`Â ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­Â `X.random --> Y`Â ã€‚é‚£ä¹ˆåœ¨å¤åˆ¶é“¾è¡¨ä¸­å¯¹åº”çš„ä¸¤ä¸ªèŠ‚ç‚¹Â `x`Â å’ŒÂ `y`Â ï¼ŒåŒæ ·æœ‰Â `x.random --> y`Â ã€‚

è¿”å›å¤åˆ¶é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚

ç”¨ä¸€ä¸ªç”±Â `n`Â ä¸ªèŠ‚ç‚¹ç»„æˆçš„é“¾è¡¨æ¥è¡¨ç¤ºè¾“å…¥/è¾“å‡ºä¸­çš„é“¾è¡¨ã€‚æ¯ä¸ªèŠ‚ç‚¹ç”¨ä¸€ä¸ªÂ `[val, random_index]`Â è¡¨ç¤ºï¼š

- `val`ï¼šä¸€ä¸ªè¡¨ç¤ºÂ `Node.val`Â çš„æ•´æ•°ã€‚
- `random_index`ï¼šéšæœºæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ç´¢å¼•ï¼ˆèŒƒå›´ä»Â `0`Â åˆ°Â `n-1`ï¼‰ï¼›å¦‚æœä¸æŒ‡å‘ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™ä¸ºÂ Â `null`Â ã€‚

ä½ çš„ä»£ç Â **åª**Â æ¥å—åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹Â `head`Â ä½œä¸ºä¼ å…¥å‚æ•°ã€‚

**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e1.png)

è¾“å…¥ï¼šhead = [[7,null],[13,0],[11,4],[10,2],[1,0]]
è¾“å‡ºï¼š[[7,null],[13,0],[11,4],[10,2],[1,0]]

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e2.png)

è¾“å…¥ï¼šhead = [[1,1],[2,1]]
è¾“å‡ºï¼š[[1,1],[2,1]]

**ç¤ºä¾‹ 3ï¼š**

**![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e3.png)**

è¾“å…¥ï¼šhead = [[3,null],[3,0],[3,null]]
è¾“å‡ºï¼š[[3,null],[3,0],[3,null]]

**æç¤ºï¼š**

- `0 <= n <= 1000`
- `-104Â <= Node.val <= 104`
- `Node.random`Â ä¸ºÂ `null`Â æˆ–æŒ‡å‘é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€‚

# è§£é¢˜æ€è·¯ä¸å®ç°


- ç¬¬ä¸€ééå†ï¼Œç”¨å­—å…¸ `old_to_new` ä¿å­˜æ˜ å°„ï¼›
- ç¬¬äºŒéæ ¹æ®æ˜ å°„å»ºç«‹ `next` å’Œ `random`ã€‚

## æ–¹æ³•ä¸€ï¼šå“ˆå¸Œè¡¨

```python
class Solution:
    def copyRandomList(self, head: 'Optional[Node]') -> 'Optional[Node]':
        if not head:
            return None
        old2new = {}
        cur = head
        while cur:
            old2new[cur] = Node(cur.val)
            cur = cur.next
        cur = head
        while cur:
            old2new[cur].next = old2new.get(cur.next)
            old2new[cur].random = old2new.get(cur.random)
            cur = cur.next
        return old2new[head]
```